## run partis
## separate each family from partis output into its own fasta file
## build a tree for each family

##### STEP 1: build tree #####

#raxml MPI is used since tree is built on a cluster
# -f d option (best scoring ML tree)
# -m GTRCAT (see: https://www.biorxiv.org/content/10.1101/2020.09.17.302505v1.abstract)
# -s input_file
# -n output_file
# -N thread_number
# -p random_seed

raxmlHPC-MPI -f d -m GTRCAT -s partition1.fasta -n sim1tree -N 10 -p 38492

#after tree is built, resolve polytomies in R using ape multi2di function: 
#multi2di(tree)

##### STEP 2: find ancestral sequence ###

# -f A option finds the ancestral sequences
# -t is the tree built in step 1 after polytomies are resolved

raxmlHPC-MPI -f A -t tree_small_no_polytomies.tree -m GTRCAT -s partition1.fasta -n sim1asr -N 2 -p 53985

##### STEP 3: compare ancestral sequences ###

#compare the root sequence from step 2 and the naive sequence from partis

